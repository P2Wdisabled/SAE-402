<html>

<head>
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no,user-scalable=no,maximum-scale=1">
  <title>Examples â€¢ Castle</title>
  <script src="https://aframe.io/releases/1.6.0/aframe.min.js"></script>
  <script src="../../dist/aframe-extras.js"></script>
  <script
    src="https://cdn.jsdelivr.net/npm/aframe-environment-component@1.3.7/dist/aframe-environment-component.min.js"></script>
  <script>
    /**
     * Basic emissive effect.
     */
    AFRAME.registerComponent('glow', {
      schema: {
        color: { default: '#ffffff', type: 'color' },
        intensity: { default: 1.0 }
      },
      init: function () {
        this.el.addEventListener('object3dset', function () {
          this.update();
        }.bind(this));
      },
      update: function () {
        var data = this.data;
        this.el.object3D.traverse(function (node) {
          if (node.isMesh) {
            node.material.emissive.copy(new THREE.Color(data.color));
            node.material.emissiveIntensity = data.intensity;
          }
        });
      }
    });

    /**
     * Simple spin-and-levitate animation.
     */
    AFRAME.registerComponent('levitate', {
      tick: function (t, dt) {
        var mesh = this.el.getObject3D('mesh');
        if (!mesh) return;
        mesh.rotation.y += 0.1 * dt / 1000;
        mesh.position.y = 0.25 * Math.sin(t / 1000);
      }
    });

    /**
     * Removes current element if on a mobile device.
     */
    AFRAME.registerComponent('not-mobile', {
      init: function () {
        var el = this.el;
        if (el.sceneEl.isMobile) {
          el.parentEl.remove(el);
        }
      }
    });
  </script>
</head>

<body>
  <a-scene>
    <a-assets>
      <a-asset-item id="navmesh" src="../assets/city/city-Mesh.glb"></a-asset-item>
      <a-asset-item id="city" src="../assets/city/city.glb"></a-asset-item>
    </a-assets>

    <!-- Player. -->
    <a-entity id="rig" movement-controls="constrainToNavMesh: true;
                                   controls: checkpoint, gamepad, trackpad, keyboard, nipple;" position="10 0 0">
      <a-entity camera position="0 1.6 0" look-controls="pointerLockEnabled: true">
        <a-cursor></a-cursor>
      </a-entity>
    </a-entity>


    <!-- Nav mesh. -->
    <a-entity nav-mesh normal-material visible="false" position="0 0 -1" gltf-model="#navmesh"></a-entity>
    <a-entity position="0 0 0" gltf-model="#city">
    </a-entity>
  </a-scene>
</body>

</html>