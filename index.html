<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PNJ avec A-Frame et Three.js</title>
    <script src="https://aframe.io/releases/1.4.2/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/aframe-physics-system@5.0.0/dist/aframe-physics-system.min.js"></script>
    <script src="https://unpkg.com/super-hands@2.0.2/dist/super-hands.min.js"></script>
    <script src="https://unpkg.com/aframe-physics-extras@0.1.2/dist/aframe-physics-extras.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/gsap@3.12.7/dist/gsap.min.js"></script>
    <script async src="https://unpkg.com/es-module-shims@1.6.3/dist/es-module-shims.js"></script>
    <script type="importmap">
    {
        "imports": {
            "three": "https://unpkg.com/three@0.154.0/build/three.module.js",
            "three/addons/": "https://unpkg.com/three@0.154.0/examples/jsm/"
        }
    }
    </script>
</head>
<body>
<a-scene physics="debug: true; gravity: -9.8">
    <a-assets>
        <a-asset-item id="pnj1" src="./NPC/Man.glb"></a-asset-item>
        <a-asset-item id="pnj2" src="./NPC/Business Man.glb"></a-asset-item>
        <a-asset-item id="pnj3" src="./NPC/Hoodie Character.glb"></a-asset-item>
        <a-mixin id="controller"
                         physics-collider
                         static-body="shape: sphere; sphereRadius: 0.02"
                         super-hands="colliderEvent: collisions;
                                                    colliderEventProperty: els;
                                                    colliderEndEvent: collisions;
                                                    colliderEndEventProperty: clearedEls"
                         collision-filter="group: hands; collidesWith: red, blue; collisionForces: false">
        </a-mixin>
        <a-mixin id="cube" dynamic-body grabbable
                         geometry="primitive: box; width: 0.5; height: 0.5; depth: 0.5">
        </a-mixin>
    </a-assets>

    <a-entity camera look-controls wasd-controls position="0 1.6 0" 
                        dynamic-body 
                        collision-filter="group: player; collidesWith: default, red, blue, hands">
    </a-entity>

    <a-entity id="leftHand" hand-controls="hand: left; handModelStyle: lowPoly; color: #ffcccc" mixin="controller"></a-entity>
    <a-entity id="rightHand" hand-controls="hand: right; handModelStyle: lowPoly; color: #ffcccc" mixin="controller"></a-entity>

    <a-entity id="pnj1-entity" gltf-model="#pnj1" position="2 0 -5" scale="0.2 0.2 0.2" dynamic-body></a-entity>
    <a-entity id="pnj2-entity" gltf-model="#pnj2" position="-2 0 -5" scale="0.5 0.5 0.5" dynamic-body></a-entity>
    <a-entity id="pnj3-entity" gltf-model="#pnj3" position="0 0 -5" scale="0.5 0.5 0.5" dynamic-body></a-entity>

    <a-light type="directional" position="2 4 3" intensity="0.6"></a-light>
    <a-light type="ambient" intensity="0.4"></a-light>

    <a-plane rotation="-90 0 0" group="red" position="0 0 0" width="20" height="20"
                     color="#7BC8A4"
                     static-body sleepy
                     collision-filter="group: red; collidesWith: default, hands, blue, player">
    </a-plane>
</a-scene>
<script src="/script.js"></script>
</body>
</html>
